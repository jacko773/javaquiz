"""
Authenticated user information
"""
type UserAuthorization {
  """
  Id of the user
  """
  id: ID!
  """
  User Default Profile Id
  """
  defaultProfileId: ID
  """
  User business accounts
  """
  businessAccounts: [UserAuthorizationBusinessAccount!]!
  """
  Business Accounts unavailable to user because of security settings
  """
  restrictedBusinessAccounts: [UserAuthorizationBusinessAccount]
}

"""
Current context user information
"""
type UserCurrentContext {
  """
  Id of the user
  """
  userId: ID!
  """
  Current profile context id
  """
  contextId: ID!
  """
  Actor Id
  """
  actorId: ID!
  """
  Impersonation type
  """
  impersonationType: ImpersonationType!
}

"""
Business account
"""
type UserAuthorizationBusinessAccount {
  """
  Id of the bussiness account
  """
  id: ID!
  """
  Legacy business account id
  """
  legacyId: Int!
  """
  Business account name
  """
  name: String!
  """
  User profile corresponding to the business account
  """
  profile: UserAuthorizationProfile!
  """
  Business account type
  """
  type: UserAuthorizationBusinessAccountType!
  """
  User permissions
  """
  permissions: [String]!
  """
  Business account security settings
  """
  restrictions: UserAuthorizationBusinessAccountRestrictions
}

"""
Business account security settings
"""
type UserAuthorizationBusinessAccountRestrictions {
  """
  List of IP addresses for authentication
  """
  whitelistedIps: [String]
  """
  Two factor authentication requirement
  """
  twoFaRequired: Boolean!
  """
  List of IP addresses for bypass two factor authentication
  """
  twoFaBypassIps: [String]
}

"""
User profile
"""
type UserAuthorizationProfile {
  """
  Profile id
  """
  id: ID!
  """
  Profile legacy id
  """
  legacyId: Int!
  """
  Profile name
  """
  name: String!
  """
  Profile type
  """
  type: UserAuthorizationAccountType!
  """
  2FA required for the profile
  """
  twoFaRequired: Boolean!
  """
  Profile not from a whitelisted Ip
  """
  restrictedIp: Boolean!
  """
  Profile from 2FA bypassed Ip
  """
  twoFaBypassedIp: Boolean!
}

"""
User details
"""
type UserDetails {
  """
  Id of the user
  """
  id: ID!,
  """
  Username
  """
  username: String!,
  """
  First Name
  """
  firstName: String!,
  """
  Last Name
  """
  lastName: String!,
  """
  User Email
  """
  email: String!,
  """
  User Locale
  """
  locale: String!,
  """
  User TimeZone Id
  """
  timeZone: String!,
  """
  Last Login Attempt Information
  """
  lastLoginAttempt: LoginAttempt
}

"""
Login Attempt Information
"""
type LoginAttempt {
  """
  Login Attempt Status
  """
  success: Boolean!,
  """
  Login Date and time which identifies last time (in UTC) when user attempted to login
  """
  attemptAt: Date!
}

"""
Authorized User details
"""
type AuthorizedUserDetails {
  """
  Actor
  """
  actor: UserDetails!,
  """
  Impersonated User
  """
  impersonatedUser: UserDetails
}

"""
Business account type
"""
enum UserAuthorizationBusinessAccountType {
  adform
  agency
  publisher
  dataProvider
}

"""
User account type
"""
enum UserAuthorizationAccountType {
  agency
  publisher
  dmp
  master
  adform
}

"""
impersonation type
"""
enum ImpersonationType {
  none
  adform
  trafficker
  profile
}

type Query {
  """
  Returns authenticated user authorization information
  """
  userAuthorization: UserAuthorization
  
  """
  Returns authenticated user current context information
  """
  userCurrentContext: UserCurrentContext

  """
  Returns authenticated user details
  """
  userDetails: UserDetails

  """
  Returns authenticated user details with original actor information
  """
  authorizedUserDetails: AuthorizedUserDetails
}
